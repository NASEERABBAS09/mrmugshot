<div class="wrapper wrapper-content animated fadeInRight">
  <div class="ibox-title">
    <h5>
      User Management
    </h5>
  </div>
  <div class="ibox-content m-b-sm border-bottom">
    <div class="row">
      <div class="col-sm-3">
        <label class="control-label">
          Type of user:
        </label>
        <select class="form-control m-b upmug-input" id="stateSheriff" name="stateSheriff" ng-model="userManagementCtrl.selectedType">
          <option value="purchased">
            Purchased Users
          </option>
          <option value="subscribed">
            Subscribed Users
          </option>
          <option value="all">
            All Users
          </option>
        </select>
      </div>
      <div class="col-sm-3" ng-if="userManagementCtrl.selectedType != 'all'">
        <label class="control-label">
          {{userManagementCtrl.stringType}} From:
        </label>
        <div class="input-group date upmug-input">
          <span class="input-group-addon">
            <i class="fa fa-calendar">
            </i>
          </span>
          <input class="form-control" ng-model="userManagementCtrl.fromDate" type="text"/>
        </div>
      </div>
      <div class="col-sm-3" ng-if="userManagementCtrl.selectedType != 'all'">
        <label class="control-label">
          To:
        </label>
        <div class="input-group date upmug-input">
          <span class="input-group-addon">
            <i class="fa fa-calendar">
            </i>
          </span>
          <input class="form-control" ng-model="userManagementCtrl.toDate" type="text"/>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <div class="ibox">
        <div class="ibox-content">
          <div class="form-group">
            <div class="input-group">
              <div class="input-group-addon"><i class="fa fa-search"></i></div>
              <input type="text" class="form-control" placeholder="Search user by email, facebook id ..." ng-model="userManagementCtrl.query">
            </div>
          </div>
          <table class="table table-striped table-bordered table-hover" id="tableMugshots">
            <thead>
              <tr>
                <th>
                  <div>
                    Avatar
                  </div>
                </th>
                <th>
                  <div ng-click="userManagementCtrl.sortType = 'email'; userManagementCtrl.sortReverse = !userManagementCtrl.sortReverse">
                    Email
                    <i class="fa fa-sort" ng-show="!userManagementCtrl.sortType">
                    </i>
                    <i class="fa fa-caret-down" ng-show="userManagementCtrl.sortType == 'email' && !userManagementCtrl.sortReverse">
                    </i>
                    <i class="fa fa-caret-up" ng-show="userManagementCtrl.sortType == 'email' && userManagementCtrl.sortReverse">
                    </i>
                  </div>
                </th>
                <th>
                  <div ng-click="userManagementCtrl.sortType = 'createdAt'; userManagementCtrl.sortReverse = !userManagementCtrl.sortReverse">
                    Date sign up
                    <i class="fa fa-sort" ng-show="!userManagementCtrl.sortType">
                    </i>
                    <i class="fa fa-caret-down" ng-show="userManagementCtrl.sortType == 'createdAt' && !userManagementCtrl.sortReverse">
                    </i>
                    <i class="fa fa-caret-up" ng-show="userManagementCtrl.sortType == 'createdAt' && userManagementCtrl.sortReverse">
                    </i>
                  </div>
                </th>
                <th>
                  <div ng-click="userManagementCtrl.sortType = 'purchasedCount'; userManagementCtrl.sortReverse = !userManagementCtrl.sortReverse">
                    # of mugshots purchased
                    <i class="fa fa-sort" ng-show="!userManagementCtrl.sortType">
                    </i>
                    <i class="fa fa-caret-down" ng-show="userManagementCtrl.sortType == 'purchasedCount' && !userManagementCtrl.sortReverse">
                    </i>
                    <i class="fa fa-caret-up" ng-show="userManagementCtrl.sortType == 'purchasedCount' && userManagementCtrl.sortReverse">
                    </i>
                  </div>
                </th>
                <th>
                  <div ng-click="userManagementCtrl.sortType = 'downloadedCount'; userManagementCtrl.sortReverse = !userManagementCtrl.sortReverse">
                    Total downloads
                    <i class="fa fa-sort" ng-show="!userManagementCtrl.sortType">
                    </i>
                    <i class="fa fa-caret-down" ng-show="userManagementCtrl.sortType == 'downloadedCount' && !userManagementCtrl.sortReverse">
                    </i>
                    <i class="fa fa-caret-up" ng-show="userManagementCtrl.sortType == 'downloadedCount' && userManagementCtrl.sortReverse">
                    </i>
                  </div>
                </th>
                <th>
                  <div ng-click="userManagementCtrl.sortType = 'subscribedCount'; userManagementCtrl.sortReverse = !userManagementCtrl.sortReverse">
                    # of subscription
                    <i class="fa fa-sort" ng-show="!userManagementCtrl.sortType">
                    </i>
                    <i class="fa fa-caret-down" ng-show="userManagementCtrl.sortType == 'subscribedCount' && !userManagementCtrl.sortReverse">
                    </i>
                    <i class="fa fa-caret-up" ng-show="userManagementCtrl.sortType == 'subscribedCount' && userManagementCtrl.sortReverse">
                    </i>
                  </div>
                </th>
                <th>
                  <div ng-click="userManagementCtrl.sortType = 'lastLogin'; userManagementCtrl.sortReverse = !userManagementCtrl.sortReverse">
                    Last login date
                    <i class="fa fa-sort" ng-show="!userManagementCtrl.sortType">
                    </i>
                    <i class="fa fa-caret-down" ng-show="userManagementCtrl.sortType == 'lastLogin' && !userManagementCtrl.sortReverse">
                    </i>
                    <i class="fa fa-caret-up" ng-show="userManagementCtrl.sortType == 'lastLogin' && userManagementCtrl.sortReverse">
                    </i>
                  </div>
                </th>
                <th>
                  <div>
                    Action
                  </div>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr ng-show="userManagementCtrl.inSubscription">
                <td colspan=11 style="text-align: center;">
                  <img alt="loading" src="/img/loading.gif" class="avatar"/>
                </td>
              </tr>
              <tr ng-repeat="user in userManagementCtrl.users" ng-show="!userManagementCtrl.inSubscription">
                <td>
                  <img alt="loading" src="{{userManagementCtrl.getPicture(user)}}" class="avatar"/>
                </td>
                <td>
                  {{userManagementCtrl.getEmail(user)}}
                </td>
                <td>
                  {{user.createdAt | date:"M/d/yyyy"}}
                </td>
                <td style="text-align: center;">
                  {{user.purchasedCount}}
                </td>
                <td style="text-align: center;">
                  {{user.downloadedCount}}
                </td>
                <td style="text-align: center;">
                  {{user.subscribedCount}}
                </td>
                <td>
                  {{user.lastLogin | date:"M/d/yyyy"}}
                </td>
                <td>
                  <a href="#" ng-class="{enable: user.action == 'disable'}" ng-click="userManagementCtrl.setTogleAction(user)">
                    {{(user.action == 'disable') ? 'Enable' : 'Disable'}}
                  </a>
                  <a href="#" ng-click="userManagementCtrl.deleteUser(user._id)">
                    Delete
                  </a>
                </td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td colspan="11">
                  <div class="pull-left">
                    <select class="form-control" ng-model="userManagementCtrl.itemsPerPage" ng-options="('show '+size+' users per page') for size in userManagementCtrl.pageSizes">
                    </select>
                  </div>
                  <div class="text-center">
                    <ul class="pagination">
                      <li ng-class="{disabled: userManagementCtrl.currentPage == 0}">
                        <a href="javascript:;" ng-click="userManagementCtrl.prevPage()">
                          « Prev
                        </a>
                      </li>
                      <li ng-class="active">
                        <a href="javascript:;">
                          {{userManagementCtrl.currentPage + 1}}
                        </a>
                      </li>
                      <li ng-class="{disabled: userManagementCtrl.currentPage == userManagementCtrl.numberPage.length - 1}">
                        <a href="javascript:;" ng-click="userManagementCtrl.nextPage()">
                          Next »
                        </a>
                      </li>
                    </ul>
                    <div class="pull-right">
                      <p>
                        Go to page:
                      </p>
                      <select class="form-control" ng-model="userManagementCtrl.currentPage" ng-options="(page + 1) for page in userManagementCtrl.numberPage">
                      </select>
                    </div>
                  </div>
                </td>
              </tr>
            </tfoot>
          </table>
          <div class="user-report">
            <div class="item">
              <div class="text">
                Total Earnings (Subscriptions)
              </div>
              <div class="number">
                ${{userManagementCtrl.totalSubscription}}
              </div>
            </div>
            <div class="item">
              <div class="text">
                Total Mugshots Purchased
              </div>
              <div class="number">
                {{userManagementCtrl.totalSingle}}
              </div>
            </div>
            <div class="item">
              <div class="text">
                Total Earnings (Purchases)
              </div>
              <div class="number">
                ${{userManagementCtrl.totalPurchased}}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
